FROM '39339 AS build
WORKDIR /build

ARG JAR_FILE

COPY target/${JAR_FILE}

RUN mkdir dependencies
RUN unzip ${JAR_FILE} -d dependencies

FROM dkdjkdj/openjdk11:latest

ARG MAIN_CLASS
ENV MAIN_CLASS ${MAIN_CLASS:-MainApplication}

COPY --from=build /build/dependencies/BOOT-INF/lib /app/lib
COPY --from=build /build/dependencies/META-INF/app /app/META-INF
COPY --from=build /build/dependencies/BOOT-INF/BOOT-INF /app

ENTRYPOINT java -cp app:app/lib/* "${MAIN_CLASS}"